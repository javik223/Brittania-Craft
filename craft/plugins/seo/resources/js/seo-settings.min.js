var SeoSettings=function(e,t){var a=this;switch(this.namespace=e,t){case"sitemap":new SeoSettings.EditableTable(this.namespace+"-customUrls",this.namespace+"-addCustomUrl");break;case"redirects":var i=document.getElementById(this.namespace+"-redirects"),n=document.getElementById(this.namespace+"-redirects-field");new SeoSettings.EditableTable(this.namespace+"-redirects",this.namespace+"-addRedirect",function(){a.redirectsForm(i,n)}),this.redirectsForm(i,n);break;case"settings":this.sitemapName(),new SeoSettings.SortableList("#"+this.namespace+"-readability")}};SeoSettings.prototype.sitemapName=function(){var e=document.getElementById(this.namespace+"-sitemapNameExample");document.getElementById(this.namespace+"-sitemapName").addEventListener("input",function(){e.textContent=this.value+".xml"})},SeoSettings.prototype.redirectsForm=function(e,t){function a(){var a={};[].slice.call(e.querySelectorAll("tbody tr:not(.hidden)")).forEach(function(e){a[+e.getAttribute("data-id")]={uri:e.querySelector('[data-name="redirects-uri"]').value.trim(),to:e.querySelector('[data-name="redirects-to"]').value.trim(),type:e.querySelector('[data-name="redirects-type"]').value}}),t.value=JSON.stringify(a).replace(/\\n/g,"\\n").replace(/\\'/g,"\\'").replace(/\\"/g,'\\"').replace(/\\&/g,"\\&").replace(/\\r/g,"\\r").replace(/\\t/g,"\\t").replace(/\\b/g,"\\b").replace(/\\f/g,"\\f")}a(),[].slice.call(document.querySelectorAll("[data-name]")).forEach(function(e){e.addEventListener("input",a)})},SeoSettings.EditableTable=function(e,t,a){var i=this;this.rowCb="function"==typeof a?a:function(){},this.table=document.getElementById(e).getElementsByTagName("tbody")[0],this.row=this.table.firstElementChild.cloneNode(!0),this.table.firstElementChild.remove(),this.row.classList.remove("hidden"),[].slice.call(this.table.getElementsByClassName("delete")).forEach(function(e){e.addEventListener("click",function(){e.parentNode.parentNode.remove(),i.rowCb()})}),document.getElementById(t).addEventListener("click",function(){i.addRow()})},SeoSettings.EditableTable.prototype.addRow=function(){var e=1;this.table.getElementsByTagName("tr").length>0&&(e=parseInt(this.table.lastElementChild.getAttribute("data-id"))+1);var t=this.row.cloneNode(!0);t.setAttribute("data-id",e),t.getElementsByClassName("delete")[0].addEventListener("click",function(){t.remove()}),this.table.appendChild(t),this.rowCb()},SeoSettings.SortableList=Garnish.DragSort.extend({$readability:null,init:function(e,t){this.$readability=$(e);var a=this.$readability.children(".input").children(":not(.filler)");t=$.extend({},SeoSettings.SortableList.defaults,t),t.container=this.$readability.children(".input"),t.helper=$.proxy(this,"getHelper"),t.caboose=".readabiltiy-row",t.axis=Garnish.Y_AXIS,t.magnetStrength=4,t.helperLagBase=1.5,this.base(a,t)},getHelper:function(e){var t=$('<div class="'+this.settings.helperClass+'"/>').appendTo(Garnish.$bod);return e.appendTo(t),t}},{defaults:{handle:".move",helperClass:"sortablelisthelper"}});